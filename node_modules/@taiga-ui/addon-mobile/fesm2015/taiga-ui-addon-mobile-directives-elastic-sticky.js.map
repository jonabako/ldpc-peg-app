{"version":3,"file":"taiga-ui-addon-mobile-directives-elastic-sticky.js","sources":["../../../projects/addon-mobile/directives/elastic-sticky/elastic-sticky.service.ts","../../../projects/addon-mobile/directives/elastic-sticky/elastic-sticky.directive.ts","../../../projects/addon-mobile/directives/elastic-sticky/elastic-sticky.module.ts","../../../projects/addon-mobile/directives/elastic-sticky/taiga-ui-addon-mobile-directives-elastic-sticky.ts"],"sourcesContent":["import {ElementRef, Inject, Injectable, NgZone, Self} from '@angular/core';\nimport {\n    SCROLL_REF_SELECTOR,\n    TUI_SCROLL_REF,\n    TuiDestroyService,\n    tuiGetElementOffset,\n    tuiScrollFrom,\n    tuiZoneOptimized,\n} from '@taiga-ui/cdk';\nimport {Observable} from 'rxjs';\nimport {\n    distinctUntilChanged,\n    map,\n    skip,\n    startWith,\n    switchMap,\n    take,\n    takeUntil,\n} from 'rxjs/operators';\n\n@Injectable()\nexport class TuiElasticStickyService extends Observable<number> {\n    constructor(\n        @Inject(TUI_SCROLL_REF) scrollRef: ElementRef<HTMLElement>,\n        @Inject(ElementRef) {nativeElement}: ElementRef<HTMLElement>,\n        @Inject(NgZone) zone: NgZone,\n        @Self() @Inject(TuiDestroyService) destroy$: TuiDestroyService,\n    ) {\n        super(subscriber =>\n            zone.onStable\n                .pipe(\n                    take(1),\n                    switchMap(() => {\n                        const host =\n                            nativeElement.closest(SCROLL_REF_SELECTOR) ||\n                            scrollRef.nativeElement;\n                        const {offsetHeight} = nativeElement;\n                        const {offsetTop} = tuiGetElementOffset(host, nativeElement);\n\n                        return tuiScrollFrom(host).pipe(\n                            map(() =>\n                                Math.max(\n                                    1 -\n                                        Math.max(\n                                            Math.round(host.scrollTop) - offsetTop,\n                                            0,\n                                        ) /\n                                            offsetHeight,\n                                    0,\n                                ),\n                            ),\n                        );\n                    }),\n                    startWith(1),\n                    distinctUntilChanged(),\n                    skip(1),\n                    tuiZoneOptimized(zone),\n                    takeUntil(destroy$),\n                )\n                .subscribe(subscriber),\n        );\n    }\n}\n","import {Directive, Inject, Output} from '@angular/core';\nimport {TuiDestroyService} from '@taiga-ui/cdk';\nimport {Observable} from 'rxjs';\n\nimport {TuiElasticStickyService} from './elastic-sticky.service';\n\n@Directive({\n    selector: '[tuiElasticSticky]',\n    providers: [TuiElasticStickyService, TuiDestroyService],\n    exportAs: 'tuiElasticSticky',\n})\nexport class TuiElasticStickyDirective {\n    @Output()\n    readonly tuiElasticSticky: Observable<number>;\n\n    constructor(\n        @Inject(TuiElasticStickyService) elasticStickyService: TuiElasticStickyService,\n    ) {\n        this.tuiElasticSticky = elasticStickyService;\n    }\n}\n","import {NgModule} from '@angular/core';\n\nimport {TuiElasticStickyDirective} from './elastic-sticky.directive';\n\n@NgModule({\n    declarations: [TuiElasticStickyDirective],\n    exports: [TuiElasticStickyDirective],\n})\nexport class TuiElasticStickyModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}