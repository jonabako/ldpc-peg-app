{"version":3,"file":"taiga-ui-addon-charts-components-bar-chart.js","sources":["../../../projects/addon-charts/components/bar-chart/bar-chart.component.ts","../../../projects/addon-charts/components/bar-chart/bar-chart.template.html","../../../projects/addon-charts/components/bar-chart/bar-chart.module.ts","../../../projects/addon-charts/components/bar-chart/taiga-ui-addon-charts-components-bar-chart.ts"],"sourcesContent":["import {\n    ChangeDetectionStrategy,\n    Component,\n    Inject,\n    Input,\n    Optional,\n    QueryList,\n    ViewChildren,\n} from '@angular/core';\nimport {\n    EMPTY_QUERY,\n    TuiContextWithImplicit,\n    TuiIdService,\n    tuiPure,\n    tuiSum,\n    TuiTypedMapper,\n} from '@taiga-ui/cdk';\nimport {\n    TuiHintHoverDirective,\n    TuiHintOptionsDirective,\n    tuiHintOptionsProvider,\n    TuiSizeL,\n    TuiSizeS,\n} from '@taiga-ui/core';\nimport {PolymorpheusContent} from '@tinkoff/ng-polymorpheus';\nimport {Observable} from 'rxjs';\n\n@Component({\n    selector: 'tui-bar-chart',\n    templateUrl: './bar-chart.template.html',\n    styleUrls: ['./bar-chart.style.less'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    viewProviders: [tuiHintOptionsProvider({direction: 'top'})],\n})\nexport class TuiBarChartComponent {\n    private readonly autoIdString: string;\n\n    @ViewChildren(TuiHintHoverDirective)\n    readonly drivers: QueryList<Observable<boolean>> = EMPTY_QUERY;\n\n    @Input()\n    value: ReadonlyArray<readonly number[]> = [];\n\n    @Input()\n    max = NaN;\n\n    @Input()\n    size: TuiSizeL | TuiSizeS | null = 'm';\n\n    @Input()\n    collapsed = false;\n\n    constructor(\n        @Optional()\n        @Inject(TuiHintOptionsDirective)\n        private readonly hintOptions: TuiHintOptionsDirective | null,\n        @Inject(TuiIdService) idService: TuiIdService,\n    ) {\n        this.autoIdString = idService.generate();\n    }\n\n    get hintContent(): PolymorpheusContent<TuiContextWithImplicit<number>> {\n        return this.hintOptions?.content || '';\n    }\n\n    get transposed(): ReadonlyArray<readonly number[]> {\n        return this.transpose(this.value);\n    }\n\n    get computedMax(): number {\n        return this.max || this.getMax(this.value, this.collapsed);\n    }\n\n    readonly percentMapper: TuiTypedMapper<[readonly number[], boolean, number], number> =\n        (set, collapsed, max) =>\n            (100 * (collapsed ? tuiSum(...set) : Math.max(...set))) / max;\n\n    getHintId(index: number): string {\n        return `${this.autoIdString}_${index}`;\n    }\n\n    @tuiPure\n    private transpose(\n        value: ReadonlyArray<readonly number[]>,\n    ): ReadonlyArray<readonly number[]> {\n        return value.reduce<ReadonlyArray<readonly number[]>>(\n            (result, next) =>\n                next.map((_, index) => [...(result[index] || []), next[index]]),\n            [],\n        );\n    }\n\n    @tuiPure\n    private getMax(values: ReadonlyArray<readonly number[]>, collapsed: boolean): number {\n        return collapsed\n            ? Math.max(\n                  // eslint-disable-next-line no-restricted-syntax\n                  ...values.reduce((result, next) =>\n                      result.map((value, index) => value + next[index]),\n                  ),\n              )\n            : values.reduce((max, value) => Math.max(...value, max), 0);\n    }\n}\n","<div\n    *ngFor=\"let set of transposed; let index = index\"\n    class=\"t-wrapper\"\n    [class.t-wrapper_hoverable]=\"!!hintContent\"\n    [class.t-wrapper_hovered]=\"drivers.get(index) | async\"\n    [tuiHint]=\"hintContent\"\n    [tuiHintContext]=\"{$implicit: index}\"\n    [tuiHintDescribe]=\"getHintId(index)\"\n    [tuiHintHost]=\"hintHost\"\n    (mouseenter.once)=\"(0)\"\n>\n    <div\n        class=\"t-container\"\n        [style.height.%]=\"set | tuiMapper: percentMapper : collapsed : computedMax\"\n    >\n        <div\n            #hintHost\n            class=\"t-host\"\n        ></div>\n        <tui-bar-set\n            class=\"t-set\"\n            [collapsed]=\"collapsed\"\n            [id]=\"getHintId(index)\"\n            [size]=\"size\"\n            [tuiFocusable]=\"!!hintContent\"\n            [value]=\"set\"\n        ></tui-bar-set>\n    </div>\n</div>\n","import {CommonModule} from '@angular/common';\nimport {NgModule} from '@angular/core';\nimport {TuiBarSetModule} from '@taiga-ui/addon-charts/components/bar-set';\nimport {TuiFocusableModule, TuiMapperPipeModule} from '@taiga-ui/cdk';\nimport {TuiHintModule} from '@taiga-ui/core';\n\nimport {TuiBarChartComponent} from './bar-chart.component';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        TuiBarSetModule,\n        TuiFocusableModule,\n        TuiHintModule,\n        TuiMapperPipeModule,\n    ],\n    declarations: [TuiBarChartComponent],\n    exports: [TuiBarChartComponent],\n})\nexport class TuiBarChartModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}