"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.setupProgressLogger = void 0;
/// <reference types="node" />
const readline_1 = require("readline");
const colored_log_1 = require("./colored-log");
const is_ci_1 = require("./is-ci");
function setupProgressLogger({ total, prefix = '', tabs = 2, }) {
    let i = 1;
    return (message, incrementIndex = true) => {
        if (is_ci_1.tuiIsCI()) {
            return;
        }
        const isLast = i === total;
        const progressLog = `(${i} / ${total}) ${prefix} ${isLast ? colored_log_1.SUCCESS_SYMBOL : message}`;
        i = incrementIndex ? i + 1 : i;
        readline_1.clearLine(process.stdout, 0);
        readline_1.cursorTo(process.stdout, 0);
        process.stdout.write(colored_log_1.SMALL_TAB_SYMBOL.repeat(tabs) + progressLog);
        if (isLast && incrementIndex) {
            process.stdout.write('\n');
        }
    };
}
exports.setupProgressLogger = setupProgressLogger;
