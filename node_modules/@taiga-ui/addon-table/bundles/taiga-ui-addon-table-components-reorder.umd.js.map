{"version":3,"file":"taiga-ui-addon-table-components-reorder.umd.js","sources":["../../../projects/addon-table/components/reorder/reorder.options.ts","../../../projects/addon-table/components/reorder/reorder.component.ts","../../../projects/addon-table/components/reorder/reorder.template.html","../../../projects/addon-table/components/reorder/reorder.module.ts","../../../projects/addon-table/components/reorder/taiga-ui-addon-table-components-reorder.ts"],"sourcesContent":["import {Provider} from '@angular/core';\nimport {tuiCreateToken, tuiProvideOptions} from '@taiga-ui/cdk';\n\nexport interface TuiReorderOptions {\n    readonly icons: {\n        readonly drag: string;\n        readonly hide: string;\n        readonly show: string;\n    };\n}\n\nexport const TUI_REORDER_DEFAULT_OPTIONS: TuiReorderOptions = {\n    icons: {\n        hide: 'tuiIconEye',\n        show: 'tuiIconEyeOff',\n        drag: 'tuiIconDrag',\n    },\n};\n\nexport const TUI_REORDER_OPTIONS = tuiCreateToken(TUI_REORDER_DEFAULT_OPTIONS);\n\nexport function tuiReorderOptionsProvider(options: Partial<TuiReorderOptions>): Provider {\n    return tuiProvideOptions(TUI_REORDER_OPTIONS, options, TUI_REORDER_DEFAULT_OPTIONS);\n}\n","import {\n    ChangeDetectionStrategy,\n    Component,\n    EventEmitter,\n    HostListener,\n    Inject,\n    Input,\n    Output,\n} from '@angular/core';\nimport {TUI_TABLE_SHOW_HIDE_MESSAGE} from '@taiga-ui/addon-table/tokens';\nimport {Observable} from 'rxjs';\n\nimport {TUI_REORDER_OPTIONS, TuiReorderOptions} from './reorder.options';\n\n@Component({\n    selector: 'tui-reorder',\n    templateUrl: './reorder.template.html',\n    styleUrls: ['./reorder.style.less'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class TuiReorderComponent<T> {\n    private dragging = false;\n\n    @Input()\n    set items(items: readonly T[]) {\n        if (\n            items.length !== this.unsortedItems.length ||\n            !items.every(item => this.unsortedItems.includes(item))\n        ) {\n            this.unsortedItems = items;\n        }\n    }\n\n    @Input()\n    enabled: readonly T[] = [];\n\n    @Output()\n    readonly itemsChange = new EventEmitter<T[]>();\n\n    @Output()\n    readonly enabledChange = new EventEmitter<T[]>();\n\n    order = new Map<number, number>();\n\n    unsortedItems: readonly T[] = [];\n\n    constructor(\n        @Inject(TUI_REORDER_OPTIONS) readonly options: TuiReorderOptions,\n        @Inject(TUI_TABLE_SHOW_HIDE_MESSAGE) readonly showHideText$: Observable<string>,\n    ) {}\n\n    @HostListener('focusout.stop')\n    noop(): void {}\n\n    @HostListener('pointerdown.silent')\n    onDrag(): void {\n        this.dragging = true;\n    }\n\n    @HostListener('document:pointerup.silent')\n    onDrop(): void {\n        if (!this.dragging) {\n            return;\n        }\n\n        this.dragging = false;\n        this.updateItems();\n    }\n\n    isEnabled(item: T): boolean {\n        return this.enabled.includes(item);\n    }\n\n    getIcon(item: T): string {\n        return this.isEnabled(item) ? this.options.icons.hide : this.options.icons.show;\n    }\n\n    toggle(toggled: T): void {\n        this.enabled = this.isEnabled(toggled)\n            ? this.enabled.filter(item => item !== toggled)\n            : this.enabled.concat(toggled);\n\n        this.updateEnabled();\n    }\n\n    move(index: number, direction: number): void {\n        const oldIndex = this.order.get(index) ?? index;\n\n        if (\n            (!oldIndex && direction < 0) ||\n            (oldIndex === this.unsortedItems.length - 1 && direction > 0)\n        ) {\n            return;\n        }\n\n        const newIndex = oldIndex + direction;\n        const oldItem = Array.from(this.order.values()).findIndex(\n            item => item === newIndex,\n        );\n\n        this.order.set(index, newIndex);\n        this.order.set(oldItem, oldIndex);\n        this.order = new Map(this.order);\n\n        this.updateItems();\n    }\n\n    private getSortedItems(): T[] {\n        const items = new Array(this.unsortedItems.length);\n\n        this.unsortedItems.forEach((item, index) => {\n            items[this.order.get(index) ?? index] = item;\n        });\n\n        return items;\n    }\n\n    private updateItems(): void {\n        this.itemsChange.emit(this.getSortedItems());\n        this.updateEnabled();\n    }\n\n    private updateEnabled(): void {\n        const enabled = this.getSortedItems().filter(item => this.isEnabled(item));\n\n        this.enabled = enabled;\n        this.enabledChange.emit(enabled);\n    }\n}\n","<tui-tiles\n    class=\"t-wrapper\"\n    [(order)]=\"order\"\n>\n    <tui-tile\n        *ngFor=\"let item of unsortedItems; let index = index\"\n        [style.order]=\"order.get(index)\"\n    >\n        <div class=\"t-item\">\n            <div\n                tuiTileHandle\n                class=\"t-draggable\"\n            >\n                <tui-svg\n                    class=\"t-icon\"\n                    [src]=\"options.icons.drag\"\n                ></tui-svg>\n                {{ item }}\n            </div>\n            <button\n                appearance=\"icon\"\n                size=\"xs\"\n                tuiIconButton\n                type=\"button\"\n                class=\"t-button\"\n                [class.t-button_hidden]=\"!isEnabled(item)\"\n                [icon]=\"getIcon(item)\"\n                [title]=\"showHideText$ | async\"\n                (click)=\"toggle(item)\"\n                (keydown.arrowDown.prevent)=\"move(index, 1)\"\n                (keydown.arrowUp.prevent)=\"move(index, -1)\"\n            ></button>\n        </div>\n    </tui-tile>\n</tui-tiles>\n","import {CommonModule} from '@angular/common';\nimport {NgModule} from '@angular/core';\nimport {TuiButtonModule, TuiSvgModule} from '@taiga-ui/core';\nimport {TuiTilesModule} from '@taiga-ui/kit';\n\nimport {TuiReorderComponent} from './reorder.component';\n\n@NgModule({\n    imports: [CommonModule, TuiSvgModule, TuiButtonModule, TuiTilesModule],\n    declarations: [TuiReorderComponent],\n    exports: [TuiReorderComponent],\n})\nexport class TuiReorderModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":["tuiCreateToken","tuiProvideOptions","EventEmitter","TUI_TABLE_SHOW_HIDE_MESSAGE","i0","i1","i2","i3","Component","ChangeDetectionStrategy","Inject","Input","Output","HostListener","CommonModule","TuiSvgModule","TuiButtonModule","TuiTilesModule","NgModule"],"mappings":"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"}