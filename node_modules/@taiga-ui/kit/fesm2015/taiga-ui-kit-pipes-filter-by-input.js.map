{"version":3,"file":"taiga-ui-kit-pipes-filter-by-input.js","sources":["../../../projects/kit/pipes/filter-by-input/filter-by-input.base.ts","../../../projects/kit/pipes/filter-by-input/filter-by-input.pipe.ts","../../../projects/kit/pipes/filter-by-input/filter-by-input-with.pipe.ts","../../../projects/kit/pipes/filter-by-input/filter-by-input.module.ts","../../../projects/kit/pipes/filter-by-input/taiga-ui-kit-pipes-filter-by-input.ts"],"sourcesContent":["import {\n    TuiFocusableElementAccessor,\n    tuiIsPresent,\n    tuiPure,\n    TuiStringHandler,\n    TuiStringMatcher,\n} from '@taiga-ui/cdk';\nimport {tuiIsFlat} from '@taiga-ui/kit/utils';\n\nexport type TuiArrayElement<A> = A extends ReadonlyArray<infer T>\n    ? A extends ReadonlyArray<ReadonlyArray<infer G>>\n        ? G\n        : T\n    : never;\n\n/**\n * @deprecated: use {@link TuiArrayElement}\n * TODO: remove in v4.0\n */\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport type ArrayElement<A> = TuiArrayElement<A>;\n\nexport abstract class AbstractTuiFilterByInput {\n    protected abstract readonly accessor: TuiFocusableElementAccessor;\n    protected abstract readonly multiSelect: unknown;\n\n    protected get query(): string {\n        return this.accessor.nativeFocusableElement\n            ? (this.accessor.nativeFocusableElement as HTMLInputElement).value || ''\n            : '';\n    }\n\n    @tuiPure\n    protected filter<T>(\n        items: ReadonlyArray<readonly T[]> | readonly T[] | null,\n        matcher: TuiStringMatcher<T>,\n        stringify: TuiStringHandler<T>,\n        query: string,\n    ): ReadonlyArray<readonly T[]> | readonly T[] | null {\n        if (!items) {\n            return null;\n        }\n\n        return tuiIsFlat(items)\n            ? this.filterFlat(items, matcher, stringify, query)\n            : this.filter2d(items, matcher, stringify, query);\n    }\n\n    private filterFlat<T>(\n        items: readonly T[],\n        matcher: TuiStringMatcher<T>,\n        stringify: TuiStringHandler<T>,\n        query: string,\n    ): readonly T[] {\n        const match = this.getMatch(items, stringify, query);\n\n        return tuiIsPresent(match) && !this.multiSelect\n            ? items\n            : items.filter(item => matcher(item, query, stringify));\n    }\n\n    private filter2d<T>(\n        items: ReadonlyArray<readonly T[]>,\n        matcher: TuiStringMatcher<T>,\n        stringify: TuiStringHandler<T>,\n        query: string,\n    ): ReadonlyArray<readonly T[]> {\n        const match = items.find(item =>\n            tuiIsPresent(this.getMatch(item, stringify, query)),\n        );\n\n        return tuiIsPresent(match) && !this.multiSelect\n            ? items\n            : items.map(inner => this.filterFlat(inner, matcher, stringify, query));\n    }\n\n    private getMatch<T>(\n        items: readonly T[],\n        stringify: TuiStringHandler<T>,\n        query: string,\n    ): T | undefined {\n        return items.find(\n            item => stringify(item).toLocaleLowerCase() === query.toLocaleLowerCase(),\n        );\n    }\n}\n","import {Inject, Optional, Pipe, PipeTransform} from '@angular/core';\nimport {\n    TUI_DEFAULT_MATCHER,\n    TUI_DEFAULT_STRINGIFY,\n    TUI_FOCUSABLE_ITEM_ACCESSOR,\n    TuiFocusableElementAccessor,\n    TuiStringMatcher,\n} from '@taiga-ui/cdk';\nimport {TUI_DATA_LIST_HOST, TuiDataListHost} from '@taiga-ui/core';\nimport {TuiMultiSelectDirective} from '@taiga-ui/kit/components/multi-select';\n\nimport {AbstractTuiFilterByInput, TuiArrayElement} from './filter-by-input.base';\n\n@Pipe({\n    name: 'tuiFilterByInput',\n    pure: false,\n})\nexport class TuiFilterByInputPipe\n    extends AbstractTuiFilterByInput\n    implements PipeTransform\n{\n    constructor(\n        @Inject(TUI_FOCUSABLE_ITEM_ACCESSOR)\n        protected readonly accessor: TuiFocusableElementAccessor,\n        @Inject(TUI_DATA_LIST_HOST)\n        private readonly host: TuiDataListHost<unknown>,\n        @Optional()\n        @Inject(TuiMultiSelectDirective)\n        protected readonly multiSelect: unknown,\n    ) {\n        super();\n    }\n\n    transform<T>(items: T, matcher?: TuiStringMatcher<TuiArrayElement<T>>): T;\n    transform<T>(\n        items: ReadonlyArray<readonly T[]> | readonly T[] | null,\n        matcher: TuiStringMatcher<T> = TUI_DEFAULT_MATCHER,\n    ): ReadonlyArray<readonly T[]> | readonly T[] | null {\n        return this.filter(\n            items,\n            matcher,\n            this.host.stringify || TUI_DEFAULT_STRINGIFY,\n            this.query,\n        );\n    }\n}\n","import {Inject, Optional, Pipe, PipeTransform} from '@angular/core';\nimport {\n    TUI_DEFAULT_MATCHER,\n    TUI_FOCUSABLE_ITEM_ACCESSOR,\n    TuiFocusableElementAccessor,\n    TuiStringHandler,\n} from '@taiga-ui/cdk';\nimport {TuiMultiSelectDirective} from '@taiga-ui/kit/components/multi-select';\n\nimport {AbstractTuiFilterByInput, TuiArrayElement} from './filter-by-input.base';\n\n/**\n * @deprecated Use {@link TuiFilterByInputPipe} instead\n */\n@Pipe({\n    name: 'tuiFilterByInputWith',\n    pure: false,\n})\nexport class TuiFilterByInputWithPipe\n    extends AbstractTuiFilterByInput\n    implements PipeTransform\n{\n    constructor(\n        @Inject(TUI_FOCUSABLE_ITEM_ACCESSOR)\n        protected readonly accessor: TuiFocusableElementAccessor,\n        @Optional()\n        @Inject(TuiMultiSelectDirective)\n        protected readonly multiSelect: unknown,\n    ) {\n        super();\n    }\n\n    transform<T>(items: T, matcher?: TuiStringHandler<TuiArrayElement<T>>): T;\n    transform<T>(\n        items: ReadonlyArray<readonly T[]> | readonly T[] | null,\n        stringify: TuiStringHandler<T>,\n    ): ReadonlyArray<readonly T[]> | readonly T[] | null {\n        return this.filter(items, TUI_DEFAULT_MATCHER, stringify, this.query);\n    }\n}\n","import {NgModule} from '@angular/core';\n\nimport {TuiFilterByInputPipe} from './filter-by-input.pipe';\nimport {TuiFilterByInputWithPipe} from './filter-by-input-with.pipe';\n\n@NgModule({\n    declarations: [TuiFilterByInputPipe, TuiFilterByInputWithPipe],\n    exports: [TuiFilterByInputPipe, TuiFilterByInputWithPipe],\n})\nexport class TuiFilterByInputPipeModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}