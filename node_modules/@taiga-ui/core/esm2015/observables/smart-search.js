import { EMPTY_ARRAY } from '@taiga-ui/cdk';
import { debounceTime, distinctUntilChanged, scan, startWith, switchMap, } from 'rxjs/operators';
export function tuiSmartSearch(getSearchFunction, searchDebounceTimeMs = 400) {
    return source => source.pipe(debounceTime(searchDebounceTimeMs), scan((previousSearched, current) => previousSearched !== '' && current.startsWith(previousSearched)
        ? previousSearched
        : current, ''), distinctUntilChanged(), switchMap(value => getSearchFunction(value).pipe(startWith(null))), startWith(EMPTY_ARRAY));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic21hcnQtc2VhcmNoLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvY29yZS9vYnNlcnZhYmxlcy9zbWFydC1zZWFyY2gudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFDLFdBQVcsRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUUxQyxPQUFPLEVBQ0gsWUFBWSxFQUNaLG9CQUFvQixFQUNwQixJQUFJLEVBQ0osU0FBUyxFQUNULFNBQVMsR0FDWixNQUFNLGdCQUFnQixDQUFDO0FBRXhCLE1BQU0sVUFBVSxjQUFjLENBQzFCLGlCQUFnRixFQUNoRix1QkFBK0IsR0FBRztJQUVsQyxPQUFPLE1BQU0sQ0FBQyxFQUFFLENBQ1osTUFBTSxDQUFDLElBQUksQ0FDUCxZQUFZLENBQUMsb0JBQW9CLENBQUMsRUFDbEMsSUFBSSxDQUNBLENBQUMsZ0JBQWdCLEVBQUUsT0FBTyxFQUFFLEVBQUUsQ0FDMUIsZ0JBQWdCLEtBQUssRUFBRSxJQUFJLE9BQU8sQ0FBQyxVQUFVLENBQUMsZ0JBQWdCLENBQUM7UUFDM0QsQ0FBQyxDQUFDLGdCQUFnQjtRQUNsQixDQUFDLENBQUMsT0FBTyxFQUNqQixFQUFFLENBQ0wsRUFDRCxvQkFBb0IsRUFBRSxFQUN0QixTQUFTLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFDbEUsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUN6QixDQUFDO0FBQ1YsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7RU1QVFlfQVJSQVl9IGZyb20gJ0B0YWlnYS11aS9jZGsnO1xuaW1wb3J0IHtPYnNlcnZhYmxlLCBPcGVyYXRvckZ1bmN0aW9ufSBmcm9tICdyeGpzJztcbmltcG9ydCB7XG4gICAgZGVib3VuY2VUaW1lLFxuICAgIGRpc3RpbmN0VW50aWxDaGFuZ2VkLFxuICAgIHNjYW4sXG4gICAgc3RhcnRXaXRoLFxuICAgIHN3aXRjaE1hcCxcbn0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5leHBvcnQgZnVuY3Rpb24gdHVpU21hcnRTZWFyY2g8VD4oXG4gICAgZ2V0U2VhcmNoRnVuY3Rpb246IChzZWFyY2g6IHN0cmluZykgPT4gT2JzZXJ2YWJsZTxyZWFkb25seSBUW10gfCByZWFkb25seSBUW11bXT4sXG4gICAgc2VhcmNoRGVib3VuY2VUaW1lTXM6IG51bWJlciA9IDQwMCxcbik6IE9wZXJhdG9yRnVuY3Rpb248c3RyaW5nLCByZWFkb25seSBUW10gfCByZWFkb25seSBUW11bXSB8IG51bGw+IHtcbiAgICByZXR1cm4gc291cmNlID0+XG4gICAgICAgIHNvdXJjZS5waXBlKFxuICAgICAgICAgICAgZGVib3VuY2VUaW1lKHNlYXJjaERlYm91bmNlVGltZU1zKSxcbiAgICAgICAgICAgIHNjYW4oXG4gICAgICAgICAgICAgICAgKHByZXZpb3VzU2VhcmNoZWQsIGN1cnJlbnQpID0+XG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzU2VhcmNoZWQgIT09ICcnICYmIGN1cnJlbnQuc3RhcnRzV2l0aChwcmV2aW91c1NlYXJjaGVkKVxuICAgICAgICAgICAgICAgICAgICAgICAgPyBwcmV2aW91c1NlYXJjaGVkXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGN1cnJlbnQsXG4gICAgICAgICAgICAgICAgJycsXG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgZGlzdGluY3RVbnRpbENoYW5nZWQoKSxcbiAgICAgICAgICAgIHN3aXRjaE1hcCh2YWx1ZSA9PiBnZXRTZWFyY2hGdW5jdGlvbih2YWx1ZSkucGlwZShzdGFydFdpdGgobnVsbCkpKSxcbiAgICAgICAgICAgIHN0YXJ0V2l0aChFTVBUWV9BUlJBWSksXG4gICAgICAgICk7XG59XG4iXX0=