{"version":3,"file":"taiga-ui-core-components-expand.umd.js","sources":["../../../projects/core/components/expand/expand-content.directive.ts","../../../projects/core/components/expand/expand.component.ts","../../../projects/core/components/expand/expand.template.html","../../../projects/core/components/expand/expand.module.ts","../../../projects/core/components/expand/taiga-ui-core-components-expand.ts"],"sourcesContent":["import {Directive} from '@angular/core';\n\n@Directive({\n    selector: '[tuiExpandContent]',\n})\nexport class TuiExpandContentDirective {}\n","import {NgIfContext} from '@angular/common';\nimport {\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    ContentChild,\n    ElementRef,\n    HostBinding,\n    HostListener,\n    Inject,\n    Input,\n    Self,\n    TemplateRef,\n    ViewChild,\n} from '@angular/core';\nimport {TUI_PARENT_ANIMATION, TuiDestroyService, TuiValuesOf} from '@taiga-ui/cdk';\nimport {TUI_EXPAND_LOADED} from '@taiga-ui/core/constants';\nimport {Observable, timer} from 'rxjs';\nimport {takeUntil} from 'rxjs/operators';\n\nimport {TuiExpandContentDirective} from './expand-content.directive';\n\nconst State = {\n    Idle: 0,\n    Loading: 1,\n    Prepared: 2,\n    Animated: 3,\n} as const;\n\nconst LOADER_HEIGHT = 48;\n\n@Component({\n    selector: 'tui-expand',\n    templateUrl: './expand.template.html',\n    styleUrls: ['./expand.style.less'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    providers: [TuiDestroyService],\n    animations: [TUI_PARENT_ANIMATION],\n})\nexport class TuiExpandComponent {\n    @ViewChild('wrapper')\n    private readonly contentWrapper?: ElementRef<HTMLDivElement>;\n\n    private state: TuiValuesOf<typeof State> = State.Idle;\n\n    @Input()\n    async = false;\n\n    @Input('expanded')\n    set expandedSetter(expanded: boolean | null) {\n        if (this.expanded === null) {\n            this.expanded = expanded;\n\n            return;\n        }\n\n        if (this.state !== State.Idle) {\n            this.expanded = expanded;\n            this.state = State.Animated;\n\n            return;\n        }\n\n        this.expanded = expanded;\n        this.retrigger(this.async && expanded ? State.Loading : State.Animated);\n    }\n\n    @ContentChild(TuiExpandContentDirective, {read: TemplateRef})\n    content: TemplateRef<NgIfContext<boolean>> | null = null;\n\n    @HostBinding('class._expanded')\n    @HostBinding('attr.aria-expanded')\n    expanded: boolean | null = null;\n\n    constructor(\n        @Inject(ChangeDetectorRef) private readonly cdr: ChangeDetectorRef,\n        @Self() @Inject(TuiDestroyService) private readonly destroy$: Observable<void>,\n    ) {}\n\n    @HostBinding('class._overflow')\n    get overflow(): boolean {\n        return this.state !== State.Idle;\n    }\n\n    @HostBinding('class._loading')\n    get loading(): boolean {\n        return !!this.expanded && this.async && this.state === State.Loading;\n    }\n\n    @HostBinding('style.height.px')\n    get height(): number | null {\n        const {expanded, state, contentWrapper} = this;\n\n        if (\n            (expanded && state === State.Prepared) ||\n            (!expanded && state === State.Animated)\n        ) {\n            return 0;\n        }\n\n        if (\n            contentWrapper &&\n            ((!expanded && state === State.Prepared) ||\n                (expanded && state === State.Animated))\n        ) {\n            return contentWrapper.nativeElement.offsetHeight;\n        }\n\n        if (contentWrapper && expanded && state === State.Loading) {\n            return Math.max(contentWrapper.nativeElement.offsetHeight, LOADER_HEIGHT);\n        }\n\n        return null;\n    }\n\n    get contentVisible(): boolean {\n        return this.expanded || this.state !== State.Idle;\n    }\n\n    @HostListener('transitionend.self', ['$event'])\n    onTransitionEnd({propertyName}: TransitionEvent): void {\n        if (propertyName === 'opacity' && this.state === State.Animated) {\n            this.state = State.Idle;\n        }\n    }\n\n    @HostListener(TUI_EXPAND_LOADED, ['$event'])\n    onExpandLoaded(event: Event): void {\n        event.stopPropagation();\n\n        if (this.state === State.Loading) {\n            this.retrigger(State.Animated);\n        }\n    }\n\n    private retrigger(state: TuiValuesOf<typeof State>): void {\n        this.state = State.Prepared;\n\n        timer(0)\n            .pipe(takeUntil(this.destroy$))\n            .subscribe(() => {\n                // We need delay to re-trigger CSS height transition from the correct number\n                if (this.state !== State.Prepared) {\n                    return;\n                }\n\n                this.state = state;\n                this.cdr.markForCheck();\n            });\n    }\n}\n","<div\n    #wrapper\n    class=\"t-wrapper\"\n    @tuiParentAnimation\n    [@.disabled]=\"overflow\"\n>\n    <ng-container *ngIf=\"contentVisible\">\n        <ng-content></ng-content>\n        <tui-loader\n            *ngIf=\"async; else content\"\n            size=\"l\"\n            [overlay]=\"true\"\n            [showLoader]=\"loading\"\n        >\n            <ng-container [ngTemplateOutlet]=\"content\"></ng-container>\n        </tui-loader>\n    </ng-container>\n</div>\n","import {CommonModule} from '@angular/common';\nimport {NgModule} from '@angular/core';\nimport {TuiLoaderModule} from '@taiga-ui/core/components/loader';\n\nimport {TuiExpandComponent} from './expand.component';\nimport {TuiExpandContentDirective} from './expand-content.directive';\n\n@NgModule({\n    imports: [CommonModule, TuiLoaderModule],\n    declarations: [TuiExpandComponent, TuiExpandContentDirective],\n    exports: [TuiExpandComponent, TuiExpandContentDirective],\n})\nexport class TuiExpandModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":["i0","Directive","timer","takeUntil","ChangeDetectorRef","TuiDestroyService","TemplateRef","i1","i2","TUI_PARENT_ANIMATION","Component","ChangeDetectionStrategy","Inject","Self","ViewChild","Input","ContentChild","HostBinding","HostListener","TUI_EXPAND_LOADED","CommonModule","TuiLoaderModule","NgModule"],"mappings":"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"}